<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <title>rensenConnect</title>
</head>
<body>
    <h1>RensenConnect Public Alpha Test</h1>

    <table class="table">
        <thead>
            <td>userId</td>
            <td>userName</td>
            <td>Difficulty</td>
            <td>Score</td>
            <td>Lifes</td>
            <td>Power</td>
            <td>Bombs</td>
        </thead>
        <tbody id="hololo">

        </tbody>
    </table>
</body>

<script>
    var x = new WebSocket("wss://"+location.hostname+"/ws");
    x.onopen = () => { x.send(JSON.stringify({type:"listener"})); }
    x.onmessage = (msg) => {
        const data = JSON.parse(msg.data);
        if (data.type === "listener" && !data.success) {
            const wa = data.data;
            document.getElementById('hololo').innerHTML = "";
            for (let i = 0; i < wa.length; i++) {
                const d = wa[i];
                console.log(d);
                document.getElementById('hololo').innerHTML += "<tr><td>"+d.userId+"</td><td>"+d.userName+"</td><td>"+d.gameInfo.difficulty+"</td><td>"+d.gameInfo.score+"</td><td>"+d.gameInfo.lifes+"</td><td>"+d.gameInfo.power+"</td><td>"+d.gameInfo.bombs+"</td></tr>";
            }
        }
    }
</script>
</html>